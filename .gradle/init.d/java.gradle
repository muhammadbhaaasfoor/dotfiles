allprojects {
    afterEvaluate { project ->
        if (project.plugins.hasPlugin('java')) {
            project.apply plugin: 'checkstyle'
            project.apply plugin: 'pmd'
            project.apply plugin: 'findbugs'
            project.apply plugin: 'checkstyle'

            tasks.withType(Compile) {
                options.deprecation = true
            }

            def checkstyleFile = new File(rootDir, "config/checkstyle.xml")
            if (checkstyleFile.exists()) {
                checkstyle {
                    configFile = checkstyleFile
                    ignoreFailures = true
                }
            } else {
                checkstyle {
                    ignoreFailures = true
                }
            }

            findbugs {
                ignoreFailures = true
            }

            pmd {
                ruleSets = ["basic", "braces", "design"]
                ignoreFailures = true
            }
        }
    }
}
